#include<iostream>
#include<ctype.h>
using namespace std;                              //指出第二个自然数及后面数据的错误时，输出时出现乱码，未查明原因
int B(char*b);
int CS(char*cs);                                 //第一个自然数及运算符的错误，指出正常 
int C(char*c);
int D(char*d);                                  //完全能判断字符串格式的正确性，在指出错误时存在一些BUG
int E(char*e);
int main()
{
	char A[100]={0};
	int one,two,three1,three2,four;
	cout<<"请输入字符串：";
    gets(A);
    char*p=&A[0],*p0=p,*p1=0,*p11=0,*p2=0,*p3=0;
    char*pp=0;
	while(isdigit(*p)==1)
	p++;
	p11=p;    //字符1首位 
	p--;
	p1=p;    //数字1末尾
	
	while(isdigit(*p)==0)
	p++;
	p--;
	p2=p;    //字符1末尾 
    while(isdigit(*p)==1)
	p++;
	p--;
	p3=p;    //数字2末尾
	  
	if(B(A)) one=1; 
	else one=0,cout<<B(A);

	if(C(A)) two=1;
	else two=0;
	
	if(CS(A)) three1=1;
	else three1=0;
	
	if(D(A)) three2=1;
	else three2=0;
	
	if(E(A)) four=1;
	else four=0;
		
	if(one==1&&two==1&&three1==1&&three2==1&&four==1)
	cout<<"语法正确\t";
	else
	{
	cout<<"语法错误\t";  
	if(one==0) cout<<*p11;
	else if(two==0)  pp=p1;
	else if(three2=0) { p1++;  pp=p1;}
	else if(three1=0) { p1+=2; pp=p1;}
	else if(four=0)   {  pp=p3;}
	cout<<"错误在"; 
	cout<<*p0;
	while(p0!=pp)
	  {
	  	p0++;
	  	cout<<*p0; 
	  }
	  cout<<"后面";
	}
	return 0;
}
int B(char*b)
{
	char *b2=b;
	if(isdigit(*b2)==1)
	return 1;
	else return 0;
}
int CS(char*cs)
{
		char *cs2=cs;
	do
	{
		cs2++;	
	}
    while(isdigit(*cs2)==1);
    int i=0;
	while(isdigit(*cs2)!=1)
	{
	    cs2++; 
		i++;
    }
	if(i<=2) 
	return 1;
	else return 0;
}
int C(char*c)
{
		char *c2=c;
	do
	{
		c2++;	
	}
    while(isdigit(*c2)==1);		
	if(*c2=='<'||*c2=='>')
	{
		c2++;
		if(*c2=='=') return 1;
		else if(isdigit(*c2)==1) return 1;
	  }  
	else if(*c2=='='&&*(c2+1)=='=') return 1;
	else return 0;
}
int D(char*d)
{
	
	char *d2=d;
	do
	{
		d2++;	
	}
    while(isdigit(*d2)==1);
    do
    {
    	d2++;
	}
    while(ispunct(*d2));
	if(isdigit(*d2)==1)
	return 1;
	else return 0; 
}
int E(char*e)
{
	
	char *e2=e;
	do
	{
		e2++;	
	}
    while(isdigit(*e2)==1);
    do
    {
    	e2++;
	}
    while(isdigit(*e2)==0);
	if(isdigit(*e2)==1)
	{
		do
		{
			e2++;
		}
		while(isdigit(*e2)==1);
		if(*e2==';'&&*(e2+1)=='\0') 
		 return 1;
		 else return 0;
	}
	else return 0;
}
	
